# Validate branch name against convention:
# - allowed types: feat, fix, chore, docs, style, refactor, perf, test, ci, build, revert
# - optional scope/description after '/', using lowercase letters, digits, dots, underscores or hyphens
# - allow main and develop as special branches
BRANCH_NAME="$(git rev-parse --abbrev-ref HEAD)"
BRANCH_PATTERN='^(main|develop|((feat|fix|chore|docs|style|refactor|perf|test|ci|build|revert)(/[a-z0-9._-]+)?))$'

if ! printf '%s' "$BRANCH_NAME" | grep -Eq "$BRANCH_PATTERN"; then
  echo "âœ– Invalid branch name: '$BRANCH_NAME'"
  echo "  Expected one of:"
  echo "    - main"
  echo "    - develop"
  echo "    - <type>/<description>"
  echo "  where <type> is one of: feat, fix, chore, docs, style, refactor, perf, test, ci, build, revert"
  echo "  example: feat/auth-login, fix/cart-totals, chore/deps-update"
  exit 1
fi

npx lint-staged